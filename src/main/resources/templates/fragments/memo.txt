-- DB 생성
CREATE TABLE TBL_MEETING_TYPE(
     MEETING_ID NUMBER,
     MEETING_TYPE VARCHAR2(100),
    CONSTRAINT PK_MEETING_ID PRIMARY KEY (MEETING_ID)

);
DROP TABLE TBL_MEETING_TYPE;
DROP TABLE TBL_MEMBER_DEBATE;

CREATE TABLE TBL_DEBATE_TYPE(
        DEBATE_TYPE_ID NUMBER,
         DEBATE_TYPE VARCHAR2(500),
        CONSTRAINT PK_DEBATE_TYPE_ID PRIMARY KEY (DEBATE_TYPE_ID)

);
DROP TABLE TBL_DEBATE_TYPE;

CREATE TABLE TBL_MEMBER_DEBATE(
    MEM_DEB_INFO NUMBER,
    DEBATE_ID NUMBER,
    CONSTRAINT PK_MEM_DEB_INFO PRIMARY KEY(MEM_DEB_INFO ),
    CONSTRAINT FK_DEBATE_ID FOREIGN KEY(DEBATE_ID)REFERENCES TBL_DEBATE_INFO(DEBATE_ID)
);
DROP TABLE TBL_MEMBER_DEBATE;
-- 토론정보
CREATE TABLE TBL_DEBATE_INFO(
    DEBATE_ID NUMBER,
    MEETING_ID NUMBER,
    DEBATE_TYPE_ID NUMBER,
    TITLE VARCHAR2(50),
    OUTLINE VARCHAR2(1000),
    GROUP_START_DATE DATE,
    GROUP_END_DATE DATE,
    DEBATE_START_DATE DATE,
    DEBATE_END_DATE DATE,
    CONSTRAINT PK_DEBATE_ID PRIMARY KEY (DEBATE_ID),
    CONSTRAINT FK_MEETING_ID FOREIGN KEY (MEETING_ID)REFERENCES TBL_MEETING_TYPE(MEETING_ID),
    CONSTRAINT FK_DEBATE_TYPE FOREIGN KEY (DEBATE_TYPE_ID)REFERENCES TBL_DEBATE_TYPE(DEBATE_TYPE_ID)
);
DROP TABLE TBL_DEBATE_INFO;

-- 토론게시판
CREATE TABLE TBL_DEBATE_POST(
         NOTICE_ID NUMBER,
         DEBATE_ID NUMBER,
         OPINION VARCHAR2(1000),
         NOTICE_DATE DATE,
         CONSTRAINT PK_NOTICE_ID PRIMARY KEY (NOTICE_ID),
         CONSTRAINT FK_DEBATE_DEBATE_ID FOREIGN KEY (DEBATE_ID)REFERENCES TBL_DEBATE_INFO(DEBATE_ID)

);
DROP TABLE TBL_DEBATE_POST;
-- 댓글
CREATE TABLE TBL_DEBATE_COMMENT(
       COMMENT_ID NUMBER,
       NOTICE_ID NUMBER,
       DEBATE_COMMENT VARCHAR2(1000),
       COMMENT_DATE DATE,
       CONSTRAINT PK_COMMENT_ID PRIMARY KEY (COMMENT_ID),
       CONSTRAINT FK_NOTICE_ID FOREIGN KEY (NOTICE_ID)REFERENCES TBL_DEBATE_POST(NOTICE_ID)
);
DROP TABLE TBL_DEBATE_COMMENT;

INSERT INTO TBL_MEETING_TYPE(MEETING_ID,MEETING_TYPE)
VALUES( 3,'SOLO');
INSERT INTO TBL_MEETING_TYPE(MEETING_ID, MEETING_TYPE)
VALUES( 2,'OFFLINE');
INSERT INTO TBL_MEETING_TYPE(MEETING_ID, MEETING_TYPE)
VALUES( 1,'ONLINE');
COMMIT;
INSERT INTO TBL_DEBATE_TYPE(DEBATE_TYPE_ID, DEBATE_TYPE)
VALUES (1,'Announcement');
INSERT INTO TBL_DEBATE_TYPE(DEBATE_TYPE_ID, DEBATE_TYPE)
VALUES (2,'FREE');
INSERT INTO TBL_DEBATE_TYPE(DEBATE_TYPE_ID, DEBATE_TYPE)
VALUES (3,'genre');

INSERT iNTO TBL_MEMBER_DEBATE(MEM_DEB_INFO,DEBATE_ID)
VALUES (2,1);

create sequence SEQ_DEBATE_ID;

insert into TBL_DEBATE_INFO(DEBATE_ID, MEETING_ID, DEBATE_TYPE_ID, TITLE, OUTLINE, GROUP_START_DATE, GROUP_END_DATE, DEBATE_START_DATE, DEBATE_END_DATE)
VALUES (1,1,1,'TEST','TEST','2024-07-23','2024-02-23','2024-06-09','2027-03-05');
COMMIT ;

select I.DEBATE_ID,T.MEETING_TYPE,D.DEBATE_TYPE, TITLE, OUTLINE,
       TO_CHAR(I.GROUP_START_DATE,'YYYY-MM-DD') AS GROUP_START_DATE, TO_CHAR(GROUP_END_DATE,'YYYY-MM-DD')AS GROUP_END_DATE,
       TO_CHAR(DEBATE_START_DATE,'YYYY-MM-DD')AS DEBATE_START_DATE, TO_CHAR(DEBATE_END_DATE,'YYYY-MM-DD')AS DEBATE_END_DATE
from TBL_DEBATE_INFO I JOIN TBL_MEETING_TYPE T
                        ON I.MEETING_ID=T.MEETING_ID
                        JOIN TBL_DEBATE_TYPE D
                        ON I.DEBATE_TYPE_ID = D.DEBATE_TYPE_ID

WHERE I.DEBATE_ID=1;

SELECT *
FROM TBL_DEBATE_INFO;

